<!-- details.html -->
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Movie Details</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Inter font -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>

<body>
  <div class="container py-5 surface">
    <div id="movieDetails" class="text-center">
      <p>Loading movie details...</p>
    </div>
  </div>

  <script>
    const apiKey = "eb967a67"; // same key
    const params = new URLSearchParams(window.location.search);
    const movieId = params.get("id"); // get id from ?id=xxxx
    const placeholderPoster = "https://via.placeholder.com/300x445?text=No+Image";

    async function loadDetails() {
      try {
        const res = await fetch(`https://www.omdbapi.com/?i=${movieId}&apikey=${apiKey}`);
        const movie = await res.json();
        const genres = (movie.Genre || "")
          .split(",")
          .map(g => g.trim())
          .filter(Boolean)
          .map(g => `<span class=\"badge bg-secondary me-1 mb-1\">${g}</span>`)
          .join(" ");

        document.getElementById("movieDetails").innerHTML = `
          <div class=\"card themed-card shadow p-3\">
            <img src=\"${movie.Poster}\" class=\"card-img-top mb-3\" style=\"max-width:300px; margin:auto;\" alt=\"${movie.Title}\" onerror=\"this.onerror=null;this.src='${placeholderPoster}'\">
            <h2>${movie.Title}</h2>
            <p><strong>Year:</strong> ${movie.Year}</p>
            <p><strong>Genre:</strong> ${genres || 'N/A'}</p>
            <p><strong>Rating:</strong> ⭐ ${movie.imdbRating}</p>
            <p><strong>Plot:</strong> ${movie.Plot}</p>
          </div>
          <div class=\"mt-3\">
            <a href=\"index.html\" class=\"back-btn btn btn-outline-warning btn-sm d-inline-flex align-items-center gap-1 px-3\" aria-label=\"Back to results\">
              <span aria-hidden=\"true\">←</span>
              <span>Back</span>
            </a>
          </div>
        `;
      } catch (err) {
        console.error(err);
      }
    }

    // apply saved theme
    const savedTheme = localStorage.getItem('theme') || 'dark';
    if (savedTheme === 'light') document.body.classList.add('theme-light');

    loadDetails();
  </script>
</body>

</html>
